\documentclass[a4paper,12pt,twoside]{book}

% ===========================
% PACCHETTI ESSENZIALI
% ===========================
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[italian]{babel}
\usepackage{geometry}
\geometry{
    a4paper,
    left=2.5cm,
    right=2.5cm,
    top=3cm,
    bottom=3cm
}

% ===========================
% GRAFICA E COLORI
% ===========================
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{tikz}
\usetikzlibrary{shapes.geometric, arrows.meta, positioning, calc, backgrounds}

% ===========================
% MATEMATICA
% ===========================
\usepackage{amsmath, amssymb, amsthm}

% ===========================
% TABELLE E LISTE
% ===========================
\usepackage{booktabs}
\usepackage{array}
\usepackage{enumitem}
\usepackage{multirow}
\usepackage{longtable}

% ===========================
% CODICE SORGENTE
% ===========================
\usepackage{listings}

% Definizione linguaggio Assembly 8086
\lstdefinelanguage[x86]{Assembler}{
    morekeywords={
        % Istruzioni trasferimento dati
        MOV, XCHG, LEA, LDS, LES, PUSH, POP, PUSHF, POPF,
        % Istruzioni aritmetiche
        ADD, ADC, SUB, SBB, INC, DEC, NEG, CMP, MUL, IMUL, DIV, IDIV,
        DAA, DAS, AAA, AAS, AAM, AAD, CBW, CWD,
        % Istruzioni logiche
        AND, OR, XOR, NOT, TEST, SHL, SHR, SAL, SAR, ROL, ROR, RCL, RCR,
        % Istruzioni di controllo
        JMP, JE, JZ, JNE, JNZ, JA, JAE, JB, JBE, JG, JGE, JL, JLE,
        JS, JNS, JO, JNO, JP, JPE, JNP, JPO, JCXZ,
        CALL, RET, RETF, RETN, IRET,
        LOOP, LOOPE, LOOPZ, LOOPNE, LOOPNZ,
        % Istruzioni stringhe
        MOVSB, MOVSW, CMPSB, CMPSW, SCASB, SCASW, LODSB, LODSW, STOSB, STOSW,
        REP, REPE, REPZ, REPNE, REPNZ,
        % Interrupt e I/O
        INT, INTO, IN, OUT,
        % Controllo processore
        NOP, HLT, WAIT, ESC, LOCK, STI, CLI, STD, CLD, CLC, STC, CMC,
        LAHF, SAHF,
        % Direttive assembler
        DB, DW, DD, DQ, DT, EQU, ORG, END, SEGMENT, ENDS, ASSUME,
        PROC, ENDP, OFFSET, PTR, BYTE, WORD, DWORD,
        % Segmenti e modelli
        .CODE, .DATA, .STACK, .MODEL, SMALL, MEDIUM, COMPACT, LARGE, HUGE
    },
    sensitive=false,
    morecomment=[l]{;},
    morestring=[b]",
    morestring=[b]'
}

% Stile listing Assembly
\lstdefinestyle{assemblystyle}{
    language=[x86]Assembler,
    basicstyle=\ttfamily\small,
    keywordstyle=\color{blue}\bfseries,
    commentstyle=\color{green!60!black}\itshape,
    stringstyle=\color{red},
    numbers=left,
    numberstyle=\tiny\color{gray},
    stepnumber=1,
    numbersep=8pt,
    backgroundcolor=\color{gray!5},
    frame=single,
    rulecolor=\color{black!30},
    tabsize=4,
    captionpos=b,
    breaklines=true,
    breakatwhitespace=false,
    showstringspaces=false,
    showtabs=false,
    xleftmargin=15pt,
    xrightmargin=5pt,
    framexleftmargin=12pt
}

\lstset{style=assemblystyle}

% ===========================
% BOX COLORATI (tcolorbox)
% ===========================
\usepackage[most]{tcolorbox}

% Box Definizione
\newtcolorbox{definizione}{
    colback=blue!5,
    colframe=blue!60!black,
    fonttitle=\bfseries,
    title=Definizione,
    enhanced,
    attach boxed title to top left={yshift=-2mm, xshift=5mm},
    boxed title style={colback=blue!60!black}
}

% Box Attenzione
\newtcolorbox{attenzione}{
    colback=red!5,
    colframe=red!70!black,
    fonttitle=\bfseries,
    title=Attenzione,
    enhanced,
    attach boxed title to top left={yshift=-2mm, xshift=5mm},
    boxed title style={colback=red!70!black}
}

% Box Nota
\newtcolorbox{nota}{
    colback=yellow!10,
    colframe=orange!80!black,
    fonttitle=\bfseries,
    title=Nota,
    enhanced,
    attach boxed title to top left={yshift=-2mm, xshift=5mm},
    boxed title style={colback=orange!80!black}
}

% Box Esempio
\newtcolorbox{esempio}{
    colback=green!5,
    colframe=green!60!black,
    fonttitle=\bfseries,
    title=Esempio,
    enhanced,
    attach boxed title to top left={yshift=-2mm, xshift=5mm},
    boxed title style={colback=green!60!black}
}

% Box Esercizio
\newtcolorbox{esercizio}[1][]{
    colback=cyan!5,
    colframe=cyan!60!black,
    fonttitle=\bfseries,
    title={Esercizio #1},
    enhanced,
    attach boxed title to top left={yshift=-2mm, xshift=5mm},
    boxed title style={colback=cyan!60!black}
}

% ===========================
% HYPERREF (sempre ultimo)
% ===========================
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,
    urlcolor=cyan,
    citecolor=green,
    pdftitle={Programmazione Assembly 8086},
    pdfauthor={ITS Antonio Scarpa},
    pdfsubject={Assembly},
    pdfkeywords={Assembly, 8086, architettura, programmazione}
}

% ===========================
% INFORMAZIONI DOCUMENTO
% ===========================
\title{\Huge\bfseries Programmazione Assembly 8086}
\author{Istituto Tecnico Superiore Antonio Scarpa\\Anno Scolastico 2025-2026}
\date{\today}

% ===========================
% INIZIO DOCUMENTO
% ===========================
\begin{document}

% Frontespizio
\maketitle

% Indice
\tableofcontents

% ===========================
% PARTE I: FONDAMENTI
% ===========================
\part{Fondamenti dell'Architettura 8086}

\include{capitoli/00_prefazione}
\include{capitoli/01_architettura_8086}
\include{capitoli/02_registri_memoria}
\include{capitoli/03_indirizzamento}

% ===========================
% PARTE II: SET DI ISTRUZIONI
% ===========================
\part{Set di Istruzioni 8086}

\include{capitoli/04_istruzioni_dati}
\include{capitoli/05_istruzioni_aritmetiche}
\include{capitoli/06_istruzioni_logiche}
\include{capitoli/07_istruzioni_controllo}

% ===========================
% PARTE III: PROGRAMMAZIONE AVANZATA
% ===========================
\part{Tecniche di Programmazione}

\include{capitoli/08_procedure_stack}
\include{capitoli/09_stringhe}
\include{capitoli/10_interrupt}
\include{capitoli/11_io_hardware}

% ===========================
% PARTE IV: APPLICAZIONI
% ===========================
\part{Progetti e Applicazioni}

\include{capitoli/12_progetti}
\include{capitoli/13_esercizi}

% ===========================
% APPENDICI
% ===========================
\appendix
\include{capitoli/appendice_soluzioni}
\include{capitoli/appendice_quick_reference}
\include{capitoli/99_bibliografia}

\end{document}
